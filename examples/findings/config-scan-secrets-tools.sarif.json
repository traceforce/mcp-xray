{
  "version": "2.1.0",
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "SecureMCP",
          "version": "1.0.2",
          "informationUri": "https://github.com/traceforce/SecureMCP",
          "rules": [
            {
              "id": "path_traversal",
              "shortDescription": {
                "text": "Potential Path Traversal in File Path Parameter"
              }
            },
            {
              "id": "injection_comment_body",
              "shortDescription": {
                "text": "Unvalidated Comment Body May Allow Injection Attacks"
              }
            },
            {
              "id": "resource_enumeration",
              "shortDescription": {
                "text": "Repository and Pull Request Enumeration Risk"
              }
            },
            {
              "id": "integer_overflow",
              "shortDescription": {
                "text": "Unbounded Numeric Input Parameters"
              }
            },
            {
              "id": "privilege_escalation",
              "shortDescription": {
                "text": "Potential Unauthorized Review Comment Submission"
              }
            },
            {
              "id": "github-fine-grained-pat",
              "shortDescription": {
                "text": "Found a GitHub Fine-Grained Personal Access Token, risking unauthorized repository access and code manipulation."
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "github-fine-grained-pat",
          "level": "error",
          "message": {
            "text": "Found a GitHub Fine-Grained Personal Access Token, risking unauthorized repository access and code manipulation."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "examples/mcp_configs/mcp_with_env.json"
                }
              }
            }
          ],
          "properties": {
            "mcpServerName": "github",
            "tool": "gitleaks",
            "type": "SECRETS"
          }
        },
        {
          "ruleId": "path_traversal",
          "level": "warning",
          "message": {
            "text": "The 'path' parameter accepts a relative file path without apparent validation or sanitization. An attacker could potentially use path traversal sequences (e.g., '../../../sensitive-file') to reference files outside the intended repository directory, potentially exposing sensitive information or manipulating unintended files. Implement strict path validation to ensure the path stays within the repository boundaries."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "examples/mcp_configs/mcp_with_env.json"
                }
              }
            }
          ],
          "properties": {
            "mcpServerName": "github",
            "mcpToolName": "add_comment_to_pending_review",
            "tool": "llm_analyzer",
            "type": "SAST"
          }
        },
        {
          "ruleId": "injection_comment_body",
          "level": "warning",
          "message": {
            "text": "The 'body' parameter accepts arbitrary string input without specified length limits or content validation. This could be exploited for: (1) Cross-Site Scripting (XSS) if the comment is rendered in a web interface without proper sanitization, (2) Markdown/HTML injection to manipulate the display of pull request reviews, or (3) Social engineering attacks through malicious content. Implement content validation, length limits, and proper output encoding."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "examples/mcp_configs/mcp_with_env.json"
                }
              }
            }
          ],
          "properties": {
            "mcpServerName": "github",
            "mcpToolName": "add_comment_to_pending_review",
            "tool": "llm_analyzer",
            "type": "SAST"
          }
        },
        {
          "ruleId": "privilege_escalation",
          "level": "warning",
          "message": {
            "text": "The tool description states it adds comments to 'the requester's latest pending pull request review', but the schema allows specification of arbitrary owner, repo, and pullNumber. This mismatch could allow an attacker to add comments to other users' pending reviews if authorization is not properly enforced at the implementation level. Ensure strict verification that the authenticated user owns the pending review being modified."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "examples/mcp_configs/mcp_with_env.json"
                }
              }
            }
          ],
          "properties": {
            "mcpServerName": "github",
            "mcpToolName": "add_comment_to_pending_review",
            "tool": "llm_analyzer",
            "type": "SAST"
          }
        },
        {
          "ruleId": "resource_enumeration",
          "level": "note",
          "message": {
            "text": "The tool accepts 'owner', 'repo', and 'pullNumber' parameters without apparent authorization checks in the schema. An attacker could potentially enumerate private repositories, pull requests, or organizational structures by iterating through different values. Ensure proper authorization checks verify that the requester has legitimate access to the specified repository and pull request before processing the comment."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "examples/mcp_configs/mcp_with_env.json"
                }
              }
            }
          ],
          "properties": {
            "mcpServerName": "github",
            "mcpToolName": "add_comment_to_pending_review",
            "tool": "llm_analyzer",
            "type": "SAST"
          }
        },
        {
          "ruleId": "integer_overflow",
          "level": "note",
          "message": {
            "text": "The 'line', 'startLine', and 'pullNumber' parameters accept numeric values without specified minimum or maximum bounds. Extremely large or negative values could cause unexpected behavior, integer overflow, or denial of service conditions. Implement reasonable bounds checking for all numeric inputs."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "examples/mcp_configs/mcp_with_env.json"
                }
              }
            }
          ],
          "properties": {
            "mcpServerName": "github",
            "mcpToolName": "add_comment_to_pending_review",
            "tool": "llm_analyzer",
            "type": "SAST"
          }
        }
      ]
    }
  ]
}